<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" lang="en" dir="ltr">
<head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1">
    <title>Users Management System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
            crossorigin="anonymous"></script>
</head>
<body>
<nav class="navbar navbar-expand-md bg-dark navbar-dark">
    <!-- Brand -->
    <a class="navbar-brand ms-4">
        <strong th:text="${admin.getUsername()}"></strong>
        <th> with roles:</th>
        <th th:text="${admin.getRolesAsString()}"/>
    </a>
    <div class="collapse navbar-collapse d-flex justify-content-end me-4">
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" th:href="@{/logout}">
                    Logout
                </a>
            </li>
        </ul>
    </div>
</nav>

<div class="container">
    <div class="row">
        <h1>Admin panel</h1>
    </div>
    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home-tab-pane"
                    type="button" role="tab" aria-controls="home-tab-pane" aria-selected="true">Users table
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile-tab-pane"
                    type="button" role="tab" aria-controls="profile-tab-pane" aria-selected="false">New User
            </button>
        </li>
    </ul>
    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="home-tab-pane" role="tabpanel" aria-labelledby="home-tab"
             tabindex="0">
            <nav class="navbar navbar-expand-md bg-light navbar-light">
                <!-- Brand -->
                <a class="navbar-brand ms-4">
                    <h5>All users</h5>
                </a>
            </nav>
            <!-- Modal -->
            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="exampleModalLabel">Are you sure?</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <p class="text-center">By doing this, all data will be permanently deleted!</p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <form th:action="@{/admin/clear}" th:method="DELETE">
                                <button type="submit" class="btn btn-danger">Confirm deletion</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table table-striped table-bordered">
                    <thead class="table-dark">
                    <tr>
                        <th> ID</th>
                        <th> First Name</th>
                        <th> Last Name</th>
                        <th> Age</th>
                        <th> Email</th>
                        <th> Role</th>
                        <th> Actions</th>
                    </tr>
                    </thead>

                    <tbody>
                    <tr th:each="user: ${users}">
                        <td th:text="${user.id}"></td>
                        <td th:text="${user.firstName}"></td>
                        <td th:text="${user.lastName}"></td>
                        <td th:text="${user.age}"></td>
                        <td th:text="${user.email}"></td>
                        <td th:text="${user.getRolesAsString()}"></td>
                        <td>
                            <div class="btn-toolbar">
                                <a th:href="@{/admin/edit/{id}(id=${user.id})}"
                                   class="btn btn-primary mx-2">Edit</a>
                                <form th:action="@{/admin/delete/{id}(id=${user.id})}" th:object="${user}"
                                      th:method="DELETE">
                                    <button type="submit" class="btn btn-danger">Delete</button>
                                </form>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <!-- Button trigger modal -->
            <button type="button" class="btn btn-danger float-md-end" data-bs-toggle="modal"
                    data-bs-target="#exampleModal">
                Clear the table
            </button>
        </div>
        <div class="tab-pane fade" id="profile-tab-pane" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
            <nav class="navbar navbar-expand-md bg-light navbar-light">
                <!-- Brand -->
                <a class="navbar-brand ms-4">
                    <h5>Add new user</h5>
                </a>
            </nav>
            <!--            -->
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-md-6 col-sm-6 container justify-content-center card">
                        <div class="card-body">
                            <th:block th:each="str : ${errors}">
                                <h3 th:text="${str}" class="text-center" style="color:red"></h3>
                            </th:block>
                            <form th:action="@{/admin}" th:object="${newUser}" th:method="POST">
                                <div class="form-group">
                                    <strong class="d-flex justify-content-center"> First name
                                        <div style="color:red" th:if="${#fields.hasErrors('firstName')}"
                                             th:errors="*{firstName}">First Name
                                            error
                                        </div>
                                    </strong>
                                    <input
                                            type="text"
                                            name="firstName"
                                            th:field="*{firstName}"
                                            class="form-control"
                                            placeholder="Enter User First Name"
                                    />
                                </div>


                                <div class="form-group">
                                    <strong class="d-flex justify-content-center"> Last name
                                        <div style="color:red" th:if="${#fields.hasErrors('lastName')}"
                                             th:errors="*{lastName}">Last Name
                                            error
                                        </div>
                                    </strong>
                                    <input
                                            type="text"
                                            name="lastName"
                                            th:field="*{lastName}"
                                            class="form-control"
                                            placeholder="Enter User Last Name"
                                    />
                                </div>

                                <div class="form-group">
                                    <strong class="d-flex justify-content-center"> Age </strong>
                                    <input
                                            type="number"
                                            min="0"
                                            name="age"
                                            th:field="*{age}"
                                            class="form-control"
                                    />
                                </div>

                                <div class="form-group">
                                    <strong class="d-flex justify-content-center"> Email
                                        <div style="color:red" th:if="${#fields.hasErrors('email')}"
                                             th:errors="*{email}">Email error
                                        </div>
                                    </strong>
                                    <input
                                            type="text"
                                            name="email"
                                            th:field="*{email}"
                                            class="form-control"
                                            placeholder="Enter User Email"
                                    />
                                </div>


                                <div class="form-group">
                                    <strong class="d-flex justify-content-center"> Password
                                        <div style="color:red" th:if="${#fields.hasErrors('password')}"
                                             th:errors="*{password}">
                                            Password error
                                        </div>
                                    </strong>
                                    <input
                                            type="text"
                                            name="password"
                                            th:field="*{password}"
                                            class="form-control"
                                            placeholder="Enter password"
                                    />
                                </div>

                                <div class="form-group">
                                    <strong class="d-flex justify-content-center"> Role
                                        <div style="color:red" th:if="${#fields.hasErrors('singleRoleId')}"
                                             th:errors="*{singleRoleId}"> Role
                                            error
                                        </div>
                                    </strong>
                                    <select th:size="${roles.size()}" name="singleRoleId" class="form-control">
                                        <option th:each="r : ${roles}" th:value="${r.getId()}"
                                                th:text="${r.getProperName()}">
                                        </option>
                                    </select>
                                </div>

                                <div class="box-footer">
                                    <button type="submit" class="btn btn-primary">
                                        Submit
                                    </button>
                                </div>
                            </form>

                        </div>
                    </div>
                </div>
            </div>
            <!--            -->
            <!--            <div class="row">-->
            <!--                <div class="col-lg-3">-->
            <!--                    <a th:href="@{admin/new}" class="btn btn-primary btn-sm mb-3">Add User</a>-->
            <!--                </div>-->
            <!--            </div>-->

        </div>
    </div>


</div>
</body>
</html>